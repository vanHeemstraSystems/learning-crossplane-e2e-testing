apiVersion: kuttl.dev/v1beta1
kind: TestAssert
commands:
- script: |
    # Get the storage account name from the XR
    STORAGE_NAME=$(kubectl get -n default xstorageaccount test-storage-e2e-001 \
      -o jsonpath='{.status.storageAccountName}')
    
    # Verify the storage account exists in Azure
    az storage account show \
      --name $STORAGE_NAME \
      --resource-group crossplane-e2e-test-rg \
      --query "provisioningState" \
      --output tsv | grep -q "Succeeded"
    
    exit $?
